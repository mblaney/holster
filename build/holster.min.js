(()=>{var e={127:e=>{var t,r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,s={};((e,t)=>{for(var o in t)r(e,o,{get:t[o],enumerable:!0})})(s,{isBrowser:()=>l,isBun:()=>d,isDeno:()=>f,isJsDom:()=>a,isNode:()=>u,isWebWorker:()=>c}),e.exports=(t=s,((e,t,s,l)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of n(t))i.call(e,s)||undefined===s||r(e,s,{get:()=>t[s],enumerable:!(l=o(t,s))||l.enumerable});return e})(r({},"__esModule",{value:!0}),t));var l="undefined"!=typeof window&&void 0!==window.document,u="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,c="object"==typeof self&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,a="undefined"!=typeof window&&"nodejs"===window.name||"undefined"!=typeof navigator&&"userAgent"in navigator&&"string"==typeof navigator.userAgent&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),f="undefined"!=typeof Deno&&void 0!==Deno.version&&void 0!==Deno.version.deno,d="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.bun},591:e=>{"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},45:e=>{e.exports=e=>{e||(e=9e3);const t={store:{},check:e=>!!t.store[e]&&t.track(e),track:r=>(t.store[r]=Date.now(),t.expiry||(t.expiry=setTimeout((()=>{const r=Date.now();Object.keys(t.store).forEach((o=>{r-t.store[o]>e&&delete t.store[o]})),t.expiry=null}),e)),r)};return t}},664:e=>{e.exports=(e,t)=>{const r=e["#"],o=e["."];var n=t[r];if(!n||!o)return;let i=n[o];return i?((n={_:n._,[o]:i})._[">"]={[o]:n._[">"][o]},{[r]:n}):void 0}},626:e=>{const t=String.fromCharCode(5),r=(e,t,r,o)=>e<t?{historical:!0}:e>t?{incoming:!0}:("string"!=typeof r&&(r=JSON.stringify(r)||""),"string"!=typeof o&&(o=JSON.stringify(o)||""),r===o?{state:!0}:r<o?{current:!0}:{incoming:!0});r.mix=(e,o,n)=>{var i=Date.now(),s={},l={};let u=0;return Object.keys(e).forEach((c=>{const a=e[c];let f=!1;Object.keys(a).forEach((e=>{if("_"===e)return;const d=a[e],p=a._[">"][e],g=(o[c]||{})[e],h=(o[c]||{_:{">":{}}})._[">"][e]||0,v=p-i;if(v>0){if(v>864e5)return;(0===u||v<u)&&(u=v),l[c]||(l[c]={_:{"#":c,">":{}}}),l[c][e]=d,l[c]._[">"][e]=p}else r(p,h,d,g).incoming&&(s[c]||(s[c]={_:{"#":c,">":{}}}),o[c]||(o[c]={_:{"#":c,">":{}}}),o[c][e]=s[c][e]=d,o[c]._[">"][e]=s[c]._[">"][e]=p,setTimeout((()=>{const r=c+t+e;n[r]&&n[r].forEach((e=>e()))}),100),f=!0)})),f&&n[c]&&setTimeout((()=>{n[c].forEach((e=>e()))}),100)})),{now:s,defer:l,wait:u}},e.exports=r},299:(e,t,r)=>{const o=r(413),n=r(643);e.exports=e=>{const t=n(e),r=new Map,i=new Map,s=e=>null===e||!0===e||!1===e||"string"==typeof e||o.rel.is(e)||o.num.is(e),l=(e,t,r)=>{r?r[e]={_:{"#":e,">":{}}}:r={[e]:{_:{"#":e,">":{}}}};for(const[o,n]of Object.entries(t))r[e][o]=n,r[e]._[">"][o]=Date.now();return r},u=e=>{const n=(e,r,n)=>{t.get(o.obj.put(e,"#",r),(async e=>{if(e.err&&console.log(e.err),e.put&&e.put[r]){delete e.put[r]._;for(const t of Object.keys(e.put[r])){const n=o.rel.is(e.put[r][t]);if(n){const s=await new Promise((e=>{const t=o.text.random();i.set(t,{chain:[{item:null,soul:n}]}),u(t).then(null,e)}));e.put[r][t]=s}}n(e.put[r])}else n(null)}))},c=t=>{const r=i.get(e);r&&void 0!==r.cb?r.cb(t):t&&console.log(t),i.delete(e)},a=(r,n)=>{const s=r&&void 0!==r.get,c=r&&void 0!==r.put,a=r&&void 0!==r.on,f=r&&void 0!==r.off;let d=!1;const p=i.get(e);for(var g=1;g<p.chain.length;g++)if(null===p.chain[g].soul){d=!0;break}if(d){const{item:d,soul:h}=p.chain[g-1];return t.get({"#":h,".":d},(v=>{if(v.err)return console.log(`error getting ${d} on ${h}: ${v.err}`),void(n&&n(null));const m=v.put&&v.put[h];if(m&&void 0!==m[d]){let v=o.rel.is(m[d]);if(v)p.chain[g].soul=v,i.set(e,{chain:p.chain,cb:p.cb}),s?u(e).then(null,r.get,n):c?u(e).put(r.put,n):a?u(e).on(n):f&&u(e).off(n);else if(s)n(m[d]);else if(c){v=o.text.random();const i={[d]:o.rel.ify(v)};t.put(l(h,i),(t=>{t?n(`error putting ${d} on ${h}: ${t}`):(p.chain[g].soul=v,u(e).put(r.put,n))}))}else a?(console.log(`error resolving on for ${d} on ${h}`),n(null)):f&&(console.log(`error resolving off for ${d} on ${h}`),n&&n(null))}else c?n(`error ${d} not found on ${h}`):(console.log(`error ${d} not found on ${h}`),n&&n(null))})),!1}return s&&null!==p.chain[p.chain.length-1].item?(p.chain.push({item:null,soul:null}),u(e).then(null,r.get,n),!1):p.chain[p.chain.length-1]};return{get:(t,r,s)=>{if("function"==typeof r&&(s=r,r=null),null===t||""===t||"_"===t)return void(s&&s(null));if(e=o.text.random(),i.set(e,{chain:[{item:t,soul:"root"}],cb:s}),!s)return u(e);const{soul:l}=a({get:r},c);l&&n(r,l,c)},then:(t,r,o)=>{const s=e=>{o?o(e):c(e)};if("function"==typeof r&&(o=r,r=null),!e)return console.log("please provide a key using get(key)"),void s(null);const l=i.get(e);if(!l)return;if(o&&void 0===l.cb&&(l.cb=o,o=null),""===t||"_"===t)return void s(null);if(null!==t&&l.chain.push({item:t,soul:null}),!l.cb)return u(e);const{soul:f}=a({get:r},s);f&&n(r,f,s)},put:(r,n)=>{const f=e=>{n?n(e):c(e)};if(!e)return void f("please provide a key using get(key)");const d=i.get(e);if(!d)return;if(!d.cb){if(!n)return;d.cb=n,n=null}const p=(e=>{if(s(e))return!0;if(o.obj.is(e)){const t=[];for(const[r,n]of Object.entries(e)){if("_"===r)return"error underscore cannot be used as an item name";if(!o.obj.is(n)&&!s(n))return`error {${r}:${n}} cannot be converted to graph`;t.push(r)}if(0!==t.length)return t}return`error ${e} cannot be converted to a graph`})(r);if("string"==typeof p)return void f(p);const{item:g,soul:h}=a({put:r},f);h&&(!0!==p?t.get({"#":h,".":g},(async e=>{if(e.err)return void f(`error getting ${h}: ${e.err}`);const n=e.put&&e.put[h]&&e.put[h][g],s=o.rel.is(n);if(!s){const e={[g]:o.rel.ify(o.text.random())};return void t.put(l(h,e),(e=>{if(e)f(`error putting ${g} on ${h}: ${e}`);else{const e=o.text.random(),t=[{item:g,soul:h}];i.set(e,{chain:t,cb:d.cb}),u(e).put(r)}}))}let c=!1;const a={};for(const e of p){const t=await new Promise((t=>{if(o.obj.is(r[e])){const n=o.text.random();i.set(n,{chain:[{item:e,soul:s}]}),u(n).put(r[e],t)}else c=!0,a[e]=r[e],t(null)}));if(t)return void f(t)}c?t.put(l(s,a),f):f()})):t.get({"#":h,".":g},(async e=>{if(e.err)return void console.log(`error getting ${h}: ${e.err}`);const n=e.put&&e.put[h]&&e.put[h][g],s=o.rel.is(n);s?t.get({"#":s},(async e=>{if(e.err)console.log(`error getting ${s}: ${e.err}`);else if(e.put&&e.put[s]){delete e.put[s]._;for(const t of Object.keys(e.put[s])){const e=await new Promise((e=>{const r=o.text.random();i.set(r,{chain:[{item:t,soul:s}]}),u(r).put(null,e)}));if(e)return void f(e)}t.put(l(h,{[g]:r}),f)}else console.log(`error ${s} not found`)})):t.put(l(h,{[g]:r}),f)})))},on:n=>{if(!n)return;if(!e)return console.log("please provide a key using get(key)"),void n(null);const{item:s,soul:l}=a({on:!0},n);l&&(i.set(e,{chain:[{item:s,soul:l}]}),r.set(n,(()=>u(e).then(null,n))),t.get({"#":l,".":s},(async e=>{if(e.err)return void console.log(`error getting ${l}: ${e.err}`);const i=e.put&&e.put[l]&&e.put[l][s],u=o.rel.is(i);u?t.on({"#":u},r.get(n)):t.on({"#":l,".":s},r.get(n))})))},off:n=>{if(!e)return console.log("please provide a key using get(key)"),void(n&&n(null));const{item:s,soul:l}=a({off:!0},n);l&&t.get({"#":l,".":s},(async u=>{if(u.err)return void console.log(`error getting ${l}: ${u.err}`);const c=u.put&&u.put[l]&&u.put[l][s],a=o.rel.is(c);a?t.off({"#":a},r.get(n)):t.off({"#":l,".":s},r.get(n)),r.delete(n),i.delete(e)}))},wire:t}};return u()}},166:(e,t,r)=>{const o=r(62),n=r(413),i=String.fromCharCode(3),s=String.fromCharCode(5),l=String.fromCharCode(31),u=e=>{var t,r=null;if(e||(e={}),e.log||(e.log=console.log),e.batch||(e.batch=1e4),e.write||(e.write=1),e.size||(e.size=1048576),!e.store)return void e.log("Radisk needs `store` interface with `{get: fn, put: fn, list: fn}`");if(!e.store.get)return void e.log("Radisk needs `store.get` interface with `(file, cb)`");if(!e.store.put)return void e.log("Radisk needs `store.put` interface with `(file, data, cb)`");if(!e.store.list)return void e.log("Radisk needs a streaming `store.list` interface with `(cb)`");const n=(r,o,i)=>(r=""+r,"function"==typeof o?(i=o,void 0!==(o=n.batch(r))||n.thrash.at&&void 0!==(o=n.thrash.at(r))?i(t,o):n.read(r,i)):(n.batch(r,o),i&&n.batch.acks.push(i),++n.batch.ed>=e.batch?n.thrash():(clearTimeout(n.batch.timeout),void(n.batch.timeout=setTimeout(n.thrash,e.write)))));return n.batch=o(),n.batch.acks=[],n.batch.ed=0,n.thrash=()=>{if(n.thrash.ing)return n.thrash.more=!0;clearTimeout(n.batch.timeout),n.thrash.more=!1,n.thrash.ing=!0;var t=n.thrash.at=n.batch;n.batch=null,n.batch=o(),n.batch.acks=[],n.batch.ed=0;let r=0;n.save(t,(o=>{++r>1||(o&&e.log(o),t.acks.forEach((e=>e(o))),n.thrash.at=null,n.thrash.ing=!1,n.thrash.more&&n.thrash())}))},n.save=(r,i)=>{const s={find:(t,r)=>{if(!(r<s.start))return s.start=r,e.store.list(s.lex),!0},lex:e=>{if(!e||e>s.start)return s.end=e,s.mix(s.file||"!",s.start,s.end),!0;s.file=e},mix:(e,l,u)=>{s.start=s.end=s.file=t,n.parse(e,((t,c)=>{if(t)return i(t);o.map(r,((e,t)=>{if(!(t<l))return u&&u<t?(s.start=t,s.start):void c(t,e)})),n.write(e,c,s.next)}))},next:e=>e?i(e):s.start?o.map(r,s.find):void i(e)};o.map(r,s.find)},n.write=(t,i,l)=>{r=null;const c={text:"",count:0,file:t,each:(t,r,n,s)=>{c.count++;var l=u.encode(s.length)+"#"+u.encode(n)+(void 0===t?"":"="+u.encode(t))+"\n";if(c.count>1&&c.text.length+l.length>e.size)return c.text="",c.limit=Math.ceil(c.count/2),c.count=0,c.sub=o(),o.map(i,c.slice),!0;c.text+=l},put:()=>{e.store.put(t,c.text,l)},slice:(e,t)=>{if(!(t<c.file)){if(++c.count>c.limit){var r=c.file;let e=t.indexOf(s);return c.file=-1===e?t:t.substring(0,e),c.sub(c.file,null),c.count=0,n.write(r,c.sub,c.next),!0}c.sub(t,e)}},next:e=>{if(e)return l(e);c.sub=o(),o.map(i,c.slice)||n.write(c.file,c.sub,l)}};o.map(i,c.each,!0)||c.put()},n.read=(o,i)=>{if(r){let e=r(o);if(void 0!==e)return i(t,e)}let l=o,u=o.indexOf(s);-1!==u&&(l=o.substring(0,u));const c={lex:e=>{if(!e)return c.file?void n.parse(c.file,c.it):void i("no file found",t);e>l||e<c.file||(c.file=e)},it:(t,n)=>{t&&e.log(t),n&&(r=n,c.value=n(o)),i(t,c.value)}};e.store.list(c.lex)},n.parse=(r,n)=>{const i={disk:o(),read:(e,r)=>{if(e)return n(e);if(!r)return n(t,i.disk);let o=[],s=i.split(r);for(;s;){let e,t,r=s[1];s=i.split(s[2])||"","#"===s[0]&&(e=s[1],o=o.slice(0,r),r<=o.length&&o.push(e)),s=i.split(s[2])||"","\n"!==s[0]&&("="===s[0]&&(t=s[1]),void 0!==e&&void 0!==t&&i.disk(o.join(""),t),s=i.split(s[2]))}n(t,i.disk)},split:e=>{if(!e)return;let t=-1,r="",o=null;for(;(o=e[++t])&&o!==l;)r+=o;let n={};return o?[r,u.decode(e.slice(t),n),e.slice(t+n.i)]:void 0}};e.store.get(r,i.read)},n};u.encode=e=>{let t="";if(e instanceof Array&&2===e.length&&(t=i+e[1],e=e[0]),"string"==typeof e){let r=0,o=null,n=l;for(;o=e[r++];)o===l&&(n+=l);return n+'"'+e+t+l}const r=n.rel.is(e);return r?l+"#"+r+t+l:n.num.is(e)?l+"+"+(e||0)+t+l:!0===e?l+"+"+t+l:!1===e?l+"-"+t+l:null===e?l+" "+t+l:void 0},u.decode=(e,t)=>{var r="",o=-1,s=0,u=null,c=null;if(e[0]!==l)return;for(;u=e[++o];)if(c){if(u===l&&--s<=0)break;r+=u}else u===l?s++:c=u||!0;t&&(t.i=o+1);let[a,f]=r.split(i);if(f){if(f=parseFloat(f),'"'===c)return[a,f];if("#"===c)return[n.rel.ify(a),f];if("+"===c)return 0===a.length?[!0,f]:[parseFloat(a),f];if("-"===c)return[!1,f];if(" "===c)return[null,f]}else{if('"'===c)return r;if("#"===c)return n.rel.ify(r);if("+"===c)return 0===r.length||parseFloat(r);if("-"===c)return!1;if(" "===c)return null}},e.exports=u},62:(e,t,r)=>{const o=r(413),n=String.fromCharCode(29),i=String.fromCharCode(30),s=()=>{const e=(t,r,s)=>{if(s||(e[n]||(e[n]={}),s=e[n]),!t)return s;let l=0,u={},c=t[l];const a=t.length-1,f=void 0===r;let d=s[c];for(;!d&&l<a;)c+=t[++l],d=s[c];if(d){if(l!==a)return d[n]||f||(d[n]={}),e(t.slice(++l),r,d[n]);if(f)return void 0===d[i]?d[n]:d[i];d[i]=r}else if(o.obj.map(s,((e,o)=>{let l=0,c="";for(;o[l]===t[l];)c+=o[l++];if(c){if(f){if(l<=a)return;return u[o.slice(l)]=e,e}let d={[o.slice(l)]:e,[t.slice(l)]:{[i]:r}};return s[c]={[n]:d},delete s[o],!0}}))){if(f)return u}else{if(f)return;s[c]||(s[c]={}),s[c][i]=r}};return e};s.map=function e(t,r,o,s){s||(s=[]);var l=t[n]||t,u=Object.keys(l).sort();for(let t=0;t<u.length;t++){let c=u[t],a=l[c],f=a[i];if(void 0!==f){if(f=r(f,s.join("")+c,c,s),void 0!==f)return f}else o&&r(void 0,s.join(""),c,s);if(a[n]){if(s.push(c),f=e(a[n],r,o,s),void 0!==f)return f;s.pop()}}},e.exports=s},621:(e,t,r)=>{const o=r(127),n=r(166),i=r(62),s=r(413),l=String.fromCharCode(5),u=String.fromCharCode(31);e.exports=e=>{s.obj.is(e)||(e={}),e.file=String(e.file||"radata"),e.store||(e.store=(e=>{if(o.isNode){const t=r(603);return t.existsSync(e)||t.mkdirSync(e),t.existsSync(e+"/!")||t.writeFileSync(e+"/!",u+"+0"+u+"#"+u+'"root'+u),{get:(r,o)=>{t.readFile(e+"/"+r,((e,t)=>{if(e){if("ENOENT"===e.code)return void o();console.log("filesystem error:",e)}t&&(t=t.toString()),o(e,t)}))},put:(r,o,n)=>{var i=Math.random().toString(36).slice(-9),s=r+"."+i+".tmp";t.writeFile(s,o,(o=>{o?n(o):t.rename(s,e+"/"+r,n)}))},list:r=>{t.readdir(e,((e,t)=>{t.forEach(r),r()}))}}}return{get:(e,t)=>{t(null,u+"+0"+u+"#"+u+'"root'+u)},put:(e,t,r)=>{r(null)},list:e=>{e("!"),e()}}})(e.file));const t=n(e);return{get:(e,r)=>{if(!e)return void r("lex required");var o,n=e["#"],u=e["."]||"";const c=(e,t)=>{o||(o={_:{"#":n,">":{}}}),o[t]=e[0],o._[">"][t]=e[1]};t(n+l+u,((e,t)=>{let l;s.obj.is(t)?(i.map(t,c),o||c(t,u),l={[n]:o}):t&&(c(t,u),l={[n]:o}),r(e,l)}))},put:(e,r)=>{if(!e)return void r("graph required");var o=0;const n=e=>{o--,n.err||(n.err=e,n.err?r(n.err):0===o&&r(null))};Object.keys(e).forEach((r=>{var i=e[r];Object.keys(i).forEach((e=>{if("_"===e)return;o++;let s=i[e],u=i._[">"][e];t(r+l+e,[s,u],n)}))}))}}}},413:e=>{const t={is:e=>!(e instanceof Array)&&(e-parseFloat(e)+1>=0||1/0===e||-1/0===e)},r={is:e=>!!e&&(e instanceof Object&&e.constructor===Object||"Object"===Object.prototype.toString.call(e).match(/^\[object (\w+)\]$/)[1]),map:(e,t,r)=>{var o=Object.keys(e);for(let n=0;n<o.length;n++){let i=t(e[o[n]],o[n],r);if(void 0!==i)return i}},put:(e,t,r)=>(e||(e={}),e[t]=r,e),del:(e,t)=>{if(e)return e[t]=null,delete e[t],e}},o=(e,t,r)=>{r.id?r.id=!1:r.id="#"===t&&"string"==typeof e&&e},n={is:e=>{if(e&&e["#"]&&!e._&&r.is(e)){let t={};if(r.map(e,o,t),t.id)return t.id}return!1},ify:e=>r.put({},"#",e)},i={random:e=>{var t="";e||(e=24);for(let r=0;r<e;r++)t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(61*Math.random()));return t}};e.exports={num:t,obj:r,rel:n,text:i}},643:(e,t,r)=>{const o=r(127),n=r(45),i=r(664),s=r(626),l=r(621),u=r(413),c=String.fromCharCode(5);e.exports=e=>{u.obj.is(e)||(e={});const t=n(e.maxAge),a=l(e),f={},d={},p={},g=(e,r)=>{const o=i(e.get,f);o?r(JSON.stringify({"#":t.track(u.text.random(9)),"@":e["#"],put:o})):a.get(e.get,((o,n)=>{r(JSON.stringify({"#":t.track(u.text.random(9)),"@":e["#"],put:n,err:o}))}))},h=(e,r)=>{const o=s.mix(e.put,f,p);a.put(o.now,(o=>{r(JSON.stringify({"#":t.track(u.text.random(9)),"@":e["#"],err:o}))})),0!==o.wait&&setTimeout((()=>h({put:o.defer},r)),o.wait)},v=e=>({get:(r,o,n)=>{if(!o)return;u.obj.is(n)||(n={});const s=i(r,f);s?o({put:s}):a.get(r,((i,s)=>{if(s)return void o({put:s,err:i});i&&console.log(i);const l=u.text.random(9);d[l]=o,e(JSON.stringify({"#":t.track(l),get:r})),setTimeout((()=>{const e=d[l];if(e){const t=r["#"],o={[t]:null};r["."]&&(o[t]={[r["."]]:null}),e({put:o}),delete d[l]}}),n.wait||100)}))},put:(r,o)=>{const n=s.mix(r,f,p);a.put(n.now,o),e(JSON.stringify({"#":t.track(u.text.random(9)),put:r}))},on:(e,t)=>{if(!t)return;let r=e["#"];r&&(e["."]&&(r+=c+e["."]),p[r]?p[r].includes(t)||p[r].push(t):p[r]=[t])},off:(e,t)=>{let r=e["#"];r&&(e["."]&&(r+=c+e["."]),p[r]&&(t?p[r].includes(t)&&p[r].splice(p[r].indexOf(t),1):delete p[r]))}});if(o.isNode){const o=r(591);let n=e.wss,i=()=>n.clients();n||(n=new o.Server({port:8080}),i=()=>n.clients);const s=(e,t)=>{i().forEach((r=>{r.readyState===o.OPEN&&r.send(e,{binary:t})}))};return n.on("connection",(e=>{e.on("error",console.error),e.on("message",((e,r)=>{const o=JSON.parse(e);if(t.check(o["#"]))return;t.track(o["#"]),o.get&&g(o,s),o.put&&h(o,s),s(e,r);const n=o["@"],i=d[n];i&&(delete o["#"],delete o["@"],i(o),delete d[n])}))})),v(s)}let m=new WebSocket("ws://localhost:8080");const b=e=>{m&&m.readyState===WebSocket.OPEN?m.send(e):console.log("websocket not available")},y=()=>{m||(m=new WebSocket("ws://localhost:8080")),m.onclose=e=>{m=null,setTimeout(y,Math.floor(5e3*Math.random()))},m.onerror=e=>{console.error(e)},m.onmessage=e=>{const r=JSON.parse(e.data);if(t.check(r["#"]))return;t.track(r["#"]),r.get&&g(r,b),r.put&&h(r,b),b(e.data);const o=r["@"],n=d[o];n&&(delete r["#"],delete r["@"],n(r),delete d[o])}};return y(),v(b)}},603:()=>{}},t={},r=function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,r),i.exports}(299);Holster=r})();
//# sourceMappingURL=holster.min.js.map